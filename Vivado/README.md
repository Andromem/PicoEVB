# Vivado Projects

To get started with the Vivado project you need Vivado 2017.2. Any edition of Vivado tools can be used, including free "WebPack" edition. Get your copy from the [Xilinx Website](https://www.xilinx.com/).

## Getting Started
- Open Vivado
- In TCL prompt, change directory to desired FPGA project (e.g. Vivado/nanoevb)
- Run TCL command: ```source project.tcl```

Once Vivado is done creating the project from TCL file, you can edit project or simply
run synthesis and implementation.

## Nanoevb Project
### Features
- Implements DMA for PCIe IP
- 8KiB BRAM connected to DMA port
- Sanity check constant 0xDEADBEEF on AXI-Lite interface
- AUXIO are mapped as 3.3V inputs

### Bitstream Generation
Run through synthesis, implementation and bitstream generation steps in Vivado after creating the project
using TCL script.

### PROM file for onboard flash
Once the bitstream is generated, in the Vivado TCL command prompt, from the Vivado/nanoevb project directory run the following command:

    write_cfgmem -force -format mcs -size 4 -interface SPIx4 \
    -loadbit {up 0x00000000 "./nanoevb/nanoevb.runs/impl_1/project_bd_wrapper.bit" } \
    -file "../../FPGA-bitfiles/Gen2/Gen2.mcs"


### Project / upgrade info
Controlled files:

- project.tcl: This was originally generated by Vivado, but it has some "custom" changes. So it needs to be hand maintained.
- project_bd.tcl: This is simply saved from the block diagram (```write_bd_tcl -force project_bd.tcl```)
 
Since the project_bd.tcl requires Vivado 2017.2 (exactly), if you want to upgrade to a new version you need to do something like:

- Use old version to open and build project
- Close old version of vivdao
- Open built project in new version of Vivado (directly, not using *.tcl file)
- Upgrade all the IP to latest version of Vivado
- Update block diagram TCL script via ```write_bd_tcl``` from new version of Vivado 
